<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <title>Lesson 15 ¬∑ Percussion Layering & World Rhythms | Music Producer Lab</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0, viewport-fit=cover" />
    <meta name="description" content="Add percussion layers from global traditions. Learn clave patterns, African rhythms, and Latin percussion." />
    <meta name="theme-color" content="#030508">
    <link rel="icon" type="image/svg+xml" href="mpl-favicon.svg">
    <link rel="manifest" href="manifest.json">
    <link rel="stylesheet" href="styles.css">
    <style>
      /* World Map */
      .world-rhythms {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
        gap: var(--space-lg);
        margin: var(--space-xl) 0;
      }

      .rhythm-region {
        background: linear-gradient(135deg, var(--bg-secondary), var(--bg-tertiary));
        border: 2px solid var(--border-subtle);
        border-radius: var(--radius-lg);
        padding: var(--space-lg);
        cursor: pointer;
        transition: all 0.2s;
      }

      .rhythm-region:hover {
        border-color: var(--accent-cyan);
        transform: translateY(-2px);
      }

      .rhythm-region h3 {
        font-size: 1.1rem;
        margin-bottom: var(--space-xs);
        display: flex;
        align-items: center;
        gap: var(--space-sm);
      }

      .rhythm-region .region-flag {
        font-size: 1.5rem;
      }

      .rhythm-region p {
        font-size: 0.85rem;
        color: var(--text-muted);
        margin-bottom: var(--space-md);
      }

      .percussion-list {
        display: flex;
        flex-wrap: wrap;
        gap: var(--space-xs);
      }

      .perc-tag {
        font-size: 0.75rem;
        padding: 4px 8px;
        border-radius: var(--radius-sm);
        background: var(--bg-tertiary);
        color: var(--text-primary);
      }

      /* Clave Pattern */
      .clave-demo {
        background: linear-gradient(135deg, #2d3436, #636e72);
        border-radius: var(--radius-lg);
        padding: var(--space-xl);
        margin: var(--space-xl) 0;
      }

      .clave-pattern {
        display: flex;
        justify-content: center;
        gap: 4px;
        margin: var(--space-lg) 0;
      }

      .clave-step {
        width: 40px;
        height: 50px;
        border-radius: var(--radius-sm);
        display: flex;
        align-items: center;
        justify-content: center;
        font-weight: 600;
        font-size: 0.85rem;
        transition: all 0.15s;
      }

      .clave-step.hit {
        background: var(--accent-coral);
        color: white;
      }

      .clave-step.rest {
        background: var(--bg-tertiary);
        color: var(--text-muted);
      }

      .clave-step.downbeat {
        border-bottom: 3px solid var(--accent-cyan);
      }

      /* Clave Types */
      .clave-types {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
        gap: var(--space-md);
        margin: var(--space-lg) 0;
      }

      .clave-type {
        background: var(--bg-secondary);
        border-radius: var(--radius-md);
        padding: var(--space-md);
        cursor: pointer;
        transition: all 0.2s;
        border: 2px solid transparent;
      }

      .clave-type:hover {
        border-color: var(--accent-amber);
      }

      .clave-type.active {
        border-color: var(--accent-coral);
        background: var(--bg-tertiary);
      }

      .clave-type h4 {
        font-size: 1rem;
        margin-bottom: var(--space-xs);
      }

      .clave-type p {
        font-size: 0.8rem;
        color: var(--text-muted);
      }

      /* Percussion Sound Cards */
      .perc-sounds {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(180px, 1fr));
        gap: var(--space-md);
        margin: var(--space-xl) 0;
      }

      .perc-sound {
        background: var(--bg-secondary);
        border-radius: var(--radius-lg);
        padding: var(--space-lg);
        text-align: center;
        cursor: pointer;
        transition: all 0.2s;
        border: 2px solid var(--border-subtle);
      }

      .perc-sound:hover {
        border-color: var(--accent-cyan);
        transform: translateY(-2px);
      }

      .perc-sound .icon {
        font-size: 2rem;
        margin-bottom: var(--space-sm);
      }

      .perc-sound h4 {
        font-size: 0.95rem;
        margin-bottom: var(--space-xs);
      }

      .perc-sound p {
        font-size: 0.75rem;
        color: var(--text-muted);
      }

      .check-list {
        list-style: none;
        padding-left: 0;
      }

      .check-list li {
        padding-left: 1.5rem;
        position: relative;
        margin-bottom: var(--space-sm);
      }

      .check-list li:before {
        content: "‚úì";
        position: absolute;
        left: 0;
        color: var(--accent-cyan);
        font-weight: bold;
      }
    </style>
  </head>
  <body>
    <div class="page">
      <div class="page-inner">
        <header class="mpl-nav">
          <div class="mpl-nav-logo">
            <img src="mpl-logo-full.svg" alt="Music Producer Lab" class="mpl-nav-logo-img" />
          </div>
          <div class="mpl-nav-actions">
            <button class="btn btn-outline" type="button" onclick="window.location.href='labs.html'">
              <span>Back to overview</span>
            </button>
          </div>
        </header>

        <section class="hero" aria-label="Lesson 15 ¬∑ World Rhythms">
          <div class="hero-copy">
            <div class="hero-copy-eyebrow">Lesson 15 ¬∑ Drum pattern</div>
            <h1 class="hero-title">Percussion Layering & <span>World Rhythms</span></h1>
            <p class="hero-subtitle">
              Add <strong>percussion layers</strong> from global traditions. Master <strong>clave patterns</strong>, <strong>Afrobeat rhythms</strong>, and <strong>Latin percussion</strong> to create rich, organic grooves.
            </p>
            <div style="margin-top:1rem;">
              <a class="btn btn-primary" href="lesson-drums-14.html"><span>‚Üê Lesson 14</span></a>
              <a class="btn btn-primary" href="lesson-drums-16.html" style="margin-left:0.6rem;"><span>Lesson 16 ‚Üí</span></a>
            </div>
          </div>

          <aside class="hero-visual" aria-hidden="true">
            <div class="hero-visual-header">
              <div class="hero-visual-title">Cultural</div>
              <div class="hero-visual-pill">World Rhythms</div>
            </div>
            <div class="hero-visual-grid">
              <div class="hero-visual-main">
                <div class="hero-visual-main-title">Global Percussion ¬∑ 100-120 BPM</div>
                <div class="hero-visual-waves">
                  <div class="hero-visual-wave"></div>
                  <div class="hero-visual-wave"></div>
                  <div class="hero-visual-wave"></div>
                  <div class="hero-visual-wave"></div>
                  <div class="hero-visual-wave"></div>
                </div>
                <div class="hero-visual-metrics">
                  <div class="hero-visual-metric">
                    <span>Focus</span>
                    <strong>Clave & Layers</strong>
                  </div>
                  <div class="hero-visual-metric">
                    <span>Time</span>
                    <strong>20‚Äì25 min</strong>
                  </div>
                </div>
              </div>
              <div class="hero-visual-side-card">
                <div class="hero-visual-side-label">Goal</div>
                <div class="hero-visual-pill-list">
                  <div class="hero-visual-pill-tag">Learn clave patterns</div>
                  <div class="hero-visual-pill-tag">Layer percussion</div>
                </div>
                <div class="hero-visual-footer">
                  <span>Afro-Cuban rhythms</span>
                  <span>World traditions</span>
                </div>
              </div>
            </div>
          </aside>
        </section>

        <section class="sections-grid" aria-label="Lesson 15 steps">
          <article class="section">
            <div class="section-eyebrow">Foundation</div>
            <h2 class="section-title">The Clave: Foundation of Latin Rhythm</h2>
            <p class="section-body">
              The <strong>clave</strong> is the rhythmic backbone of Afro-Cuban music. It's a five-note pattern that repeats across two bars and guides all other rhythms in the arrangement.
            </p>

            <div class="clave-demo">
              <h3 style="text-align: center; margin-bottom: var(--space-md);">3-2 Son Clave</h3>
              <div class="clave-pattern" id="clavePattern">
                <!-- Bar 1: 3 hits -->
                <div class="clave-step hit downbeat">1</div>
                <div class="clave-step rest">¬∑</div>
                <div class="clave-step rest">¬∑</div>
                <div class="clave-step hit">4</div>
                <div class="clave-step rest">¬∑</div>
                <div class="clave-step rest">¬∑</div>
                <div class="clave-step hit">7</div>
                <div class="clave-step rest">¬∑</div>
                <!-- Bar 2: 2 hits -->
                <div class="clave-step rest downbeat">¬∑</div>
                <div class="clave-step rest">¬∑</div>
                <div class="clave-step rest">¬∑</div>
                <div class="clave-step hit">4</div>
                <div class="clave-step rest">¬∑</div>
                <div class="clave-step rest">¬∑</div>
                <div class="clave-step rest">¬∑</div>
                <div class="clave-step hit">8</div>
              </div>

              <div style="text-align: center; margin-top: var(--space-md);">
                <span style="color: var(--accent-cyan); font-size: 0.8rem;">Bar 1 (3 hits)</span>
                <span style="margin: 0 var(--space-md); color: var(--text-muted);">|</span>
                <span style="color: var(--accent-amber); font-size: 0.8rem;">Bar 2 (2 hits)</span>
              </div>
            </div>

            <div class="clave-types">
              <div class="clave-type active" data-clave="son-32">
                <h4>3-2 Son Clave</h4>
                <p>The most common. Bar 1 has 3 notes, Bar 2 has 2.</p>
              </div>
              <div class="clave-type" data-clave="son-23">
                <h4>2-3 Son Clave</h4>
                <p>Reversed‚Äîstarts with 2 notes. Different feel, same pattern.</p>
              </div>
              <div class="clave-type" data-clave="rumba-32">
                <h4>3-2 Rumba Clave</h4>
                <p>3rd note moved late. More syncopated, common in salsa.</p>
              </div>
              <div class="clave-type" data-clave="bossa">
                <h4>Bossa Nova Clave</h4>
                <p>Brazilian variation. Used in bossa nova and samba.</p>
              </div>
            </div>
          </article>

          <article class="section">
            <div class="section-eyebrow">Global Traditions</div>
            <h2 class="section-title">World Rhythm Traditions</h2>
            <p class="section-body">
              Different cultures have developed unique rhythmic patterns and percussion instruments. Learning these enriches your production palette.
            </p>

            <div class="world-rhythms">
              <div class="rhythm-region">
                <h3><span class="region-flag">üá®üá∫</span> Afro-Cuban</h3>
                <p>Foundation of salsa, mambo, and Latin jazz. Clave-based patterns with layered percussion.</p>
                <div class="percussion-list">
                  <span class="perc-tag">Clave</span>
                  <span class="perc-tag">Congas</span>
                  <span class="perc-tag">Bongos</span>
                  <span class="perc-tag">Timbales</span>
                  <span class="perc-tag">Cowbell</span>
                </div>
              </div>

              <div class="rhythm-region">
                <h3><span class="region-flag">üáßüá∑</span> Brazilian</h3>
                <p>Samba, bossa nova, and bai√£o rhythms with complex polyrhythmic layering.</p>
                <div class="percussion-list">
                  <span class="perc-tag">Surdo</span>
                  <span class="perc-tag">Pandeiro</span>
                  <span class="perc-tag">Tamborim</span>
                  <span class="perc-tag">Agog√¥</span>
                  <span class="perc-tag">Cu√≠ca</span>
                </div>
              </div>

              <div class="rhythm-region">
                <h3><span class="region-flag">üá≥üá¨</span> West African</h3>
                <p>Afrobeat, highlife, and traditional djembe rhythms. Foundation for modern Afropop.</p>
                <div class="percussion-list">
                  <span class="perc-tag">Djembe</span>
                  <span class="perc-tag">Talking Drum</span>
                  <span class="perc-tag">Shekere</span>
                  <span class="perc-tag">Udu</span>
                  <span class="perc-tag">Bells</span>
                </div>
              </div>

              <div class="rhythm-region">
                <h3><span class="region-flag">üáØüá≤</span> Caribbean</h3>
                <p>Reggae, dancehall, and calypso rhythms with distinctive offbeat emphasis.</p>
                <div class="percussion-list">
                  <span class="perc-tag">Steel Drum</span>
                  <span class="perc-tag">Nyabinghi Drums</span>
                  <span class="perc-tag">Bongo</span>
                  <span class="perc-tag">Shaker</span>
                </div>
              </div>

              <div class="rhythm-region">
                <h3><span class="region-flag">üáÆüá≥</span> Indian</h3>
                <p>Tabla patterns, complex time cycles (tala), and ornamental techniques.</p>
                <div class="percussion-list">
                  <span class="perc-tag">Tabla</span>
                  <span class="perc-tag">Dholak</span>
                  <span class="perc-tag">Mridangam</span>
                  <span class="perc-tag">Ghatam</span>
                </div>
              </div>

              <div class="rhythm-region">
                <h3><span class="region-flag">üá™üá¨</span> Middle Eastern</h3>
                <p>Doumbek patterns, maqsum, and baladi rhythms with complex ornamentation.</p>
                <div class="percussion-list">
                  <span class="perc-tag">Doumbek</span>
                  <span class="perc-tag">Frame Drum</span>
                  <span class="perc-tag">Riq</span>
                  <span class="perc-tag">Sagat</span>
                </div>
              </div>
            </div>
          </article>

          <article class="section">
            <div class="section-eyebrow">Instruments</div>
            <h2 class="section-title">Common Percussion Sounds</h2>
            <p class="section-body">
              These percussion instruments add texture and movement to any groove. Learn their roles and typical patterns.
            </p>

            <div class="perc-sounds">
              <div class="perc-sound">
                <div class="icon">ü™ò</div>
                <h4>Congas</h4>
                <p>Low, mid, high tones. Tumbao patterns.</p>
              </div>
              <div class="perc-sound">
                <div class="icon">üîî</div>
                <h4>Cowbell</h4>
                <p>Driving offbeat patterns. Essential for salsa.</p>
              </div>
              <div class="perc-sound">
                <div class="icon">üéê</div>
                <h4>Shaker</h4>
                <p>16th note pulse. Adds air and movement.</p>
              </div>
              <div class="perc-sound">
                <div class="icon">ü™á</div>
                <h4>Tambourine</h4>
                <p>Accent upbeats. Adds brightness and shimmer.</p>
              </div>
              <div class="perc-sound">
                <div class="icon">ü•¢</div>
                <h4>Claves</h4>
                <p>The heartbeat pattern. Guides all other parts.</p>
              </div>
              <div class="perc-sound">
                <div class="icon">ü™à</div>
                <h4>Guiro</h4>
                <p>Scraping rhythm. Long-short patterns.</p>
              </div>
            </div>
          </article>
        </section>

        <!-- Exercise Instructions -->
        <section class="exercise-instructions" style="margin-top: var(--space-2xl);">
          <div class="exercise-box">
            <div class="section-eyebrow">Exercise</div>
            <h2 class="section-title">Layer a Latin Groove</h2>
            <p class="section-body">Build a layered percussion groove using clave, congas, and shaker.</p>

            <div class="exercise-steps">
              <h3>What to do:</h3>
              <ol class="exercise-checklist">
                <li>Start with the 3-2 son clave as your guide.</li>
                <li>Add a conga pattern that complements the clave.</li>
                <li>Layer a shaker on 16th notes for pulse.</li>
                <li>Add cowbell hits on the offbeats.</li>
              </ol>
            </div>

            <div class="exercise-tip">
              <strong>Golden Rule:</strong> Every part should respect the clave. If something clashes, it's probably crossing the clave in the wrong place.
            </div>
          </div>
        </section>

        <!-- Full-Width Sequencer -->
        <section class="sequencer-section" style="margin-top: var(--space-xl);">
          <div class="section-eyebrow" style="margin-bottom: var(--space-sm);">Interactive Sequencer</div>
          <h2 class="section-title" style="margin-bottom: var(--space-lg);">Percussion Sequencer</h2>

          <div class="sequencer" id="mpl-sequencer-collection">
            <!-- Sequencer will be created by JS -->
          </div>

          <div style="display:flex;gap:0.75rem;margin-top:1.5rem;flex-wrap:wrap;align-items:center;">
            <button type="button" class="btn btn-outline" id="mpl-seq-play-all">
              <svg width="16" height="16" viewBox="0 0 24 24" fill="currentColor" style="margin-right:4px;"><polygon points="5 3 19 12 5 21 5 3"/></svg>
              Play
            </button>
            <button type="button" class="btn btn-outline" id="mpl-seq-stop-all">
              <svg width="16" height="16" viewBox="0 0 24 24" fill="currentColor" style="margin-right:4px;"><rect x="6" y="4" width="4" height="16"/><rect x="14" y="4" width="4" height="16"/></svg>
              Stop
            </button>
            <button type="button" class="btn btn-primary" id="mpl-seq-check-all">
              Check Exercise
            </button>

            <div id="mpl-seq-next-lesson-wrap" style="margin-left:auto;">
              <button class="btn btn-primary" id="mpl-next-lesson" disabled title="Complete exercise to unlock">
                Next Lesson &rarr;
              </button>
            </div>
          </div>

          <div class="sequencer-status" id="mpl-seq-status" aria-live="polite" style="margin-top:1rem;">
            Complete the pattern to continue.
          </div>
        </section>

        <!-- Key Takeaways -->
        <section class="sections-grid" style="margin-top: var(--space-2xl);">
          <article class="section">
            <div class="section-eyebrow">Summary</div>
            <h2 class="section-title">Key Takeaways</h2>
            <ul class="check-list">
              <li><strong>Clave is king:</strong> All Latin percussion follows the clave pattern</li>
              <li><strong>Layer textures:</strong> Combine low (congas), mid (cowbell), high (shaker) frequencies</li>
              <li><strong>Respect tradition:</strong> Learn authentic patterns before experimenting</li>
              <li><strong>World rhythms enrich:</strong> Afrobeat, Brazilian, Caribbean influences add depth</li>
              <li><strong>Less is more:</strong> Each layer should have a purpose and space</li>
            </ul>
          </article>
        </section>

        <footer class="footer">
          <div>&copy; <span id="mpl-year"></span> Music Producer Lab ¬∑ Lesson 15</div>
          <div><a class="footer-link" href="labs.html">Back to overview</a></div>
        </footer>
      </div>
    </div>

    <script>
      document.getElementById("mpl-year").textContent = new Date().getFullYear();

      document.querySelectorAll('.clave-type').forEach(type => {
        type.addEventListener('click', () => {
          document.querySelectorAll('.clave-type').forEach(t => t.classList.remove('active'));
          type.classList.add('active');
        });
      });
    </script>
    <script type="module">
      import { initDrumSequencer } from './sequencer.js';

      const LESSON_KEY = "mpl-drums-15-progress";
      const NEXT_LESSON_URL = "lesson-drums-16.html";

      const instruments = [
        { id: "kick", label: "Kick", color: "linear-gradient(135deg, #ff6b6b, #ee5a24)", target: [0, 8], instructions: "Foundation kick" },
        { id: "clap", label: "Clap", color: "linear-gradient(135deg, #feca57, #ff9f43)", target: [4, 12], instructions: "Clap backbeat" },
        { id: "rim", label: "Rim", color: "linear-gradient(135deg, #00d2d3, #01a3a4)", target: [0, 3, 6, 10], instructions: "Clave pattern" }
      ];

      initDrumSequencer(instruments, LESSON_KEY, NEXT_LESSON_URL);
    </script>
  </body>
</html>
