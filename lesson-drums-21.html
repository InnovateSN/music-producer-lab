<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Lesson 21 ¬∑ Drums & Rhythm | Music Producer Lab</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0, viewport-fit=cover" />
  <meta name="description" content="Free Lesson 21 from Music Producer Lab: advanced drums & rhythm production techniques." />
  <meta name="theme-color" content="#030508">
  <link rel="icon" type="image/svg+xml" href="mpl-favicon.svg">
  <link rel="manifest" href="manifest.json">
  <link rel="stylesheet" href="styles.css">
</head>
<body>
  <div id="navbar-placeholder"></div>
  <main class="main-content container">
    <section class="hero" id="mpl-hero" aria-label="Lesson hero" style="display: flex; align-items: center; gap: var(--space-3xl);">
      <div class="hero-copy" style="flex: 1; max-width: none;">
        <div class="hero-copy-eyebrow">Drums & Rhythm ¬∑ Lesson 21</div>
        <h1 class="hero-title"><span id="mpl-hero-title">Loading...</span><span id="mpl-hero-title-highlight"></span></h1>
        <p class="hero-subtitle" id="mpl-hero-subtitle">Loading lesson content...</p>
      </div>
      <aside class="hero-visual" aria-hidden="true">
        <div class="hero-visual-header"><div class="hero-visual-title">Free lesson</div><div class="hero-visual-pill">Advanced drums</div></div>
        <div class="hero-visual-grid">
          <div class="hero-visual-main">
            <div class="hero-visual-main-title"><span>Lesson 21</span></div>
            <div class="hero-visual-waves"><div class="hero-visual-wave"></div><div class="hero-visual-wave"></div><div class="hero-visual-wave"></div></div>
            <div class="hero-visual-metrics"><div class="hero-visual-metric"><span>Level</span><strong>Advanced</strong></div><div class="hero-visual-metric"><span>Time</span><strong>20-25 min</strong></div></div>
          </div>
        </div>
      </aside>
    </section>

    <section class="exercise-instructions" id="mpl-exercise-section" style="margin-top: var(--space-2xl);">
      <div class="exercise-box">
        <div class="section-eyebrow">Exercise</div>
        <h2 class="section-title" id="mpl-exercise-title">Loading exercise...</h2>
        <p class="section-body" id="mpl-exercise-description"></p>
        <div class="exercise-steps" id="mpl-exercise-steps-wrap"><h3>What to do:</h3><ol class="exercise-checklist" id="mpl-exercise-steps"></ol></div>
        <div class="exercise-tip" id="mpl-exercise-tip" style="display:none;"><strong>Tip:</strong> <span id="mpl-exercise-tip-text"></span></div>
      </div>
    </section>

    <section class="sequencer-section" id="mpl-sequencer-section" style="margin-top: var(--space-xl);">
      <div class="section-eyebrow" style="margin-bottom: var(--space-sm);">Interactive Drum Sequencer</div>
      <h2 class="section-title" style="margin-bottom: var(--space-lg);">Build Your Pattern</h2>
      <div class="sequencer" id="mpl-sequencer-collection"></div>
      <div class="sequencer-controls" style="display:flex;gap:0.75rem;margin-top:1.5rem;flex-wrap:wrap;">
        <button id="mpl-seq-play-all" class="btn btn-primary" style="min-width:100px;"><img src="images/PLAY.png" alt="Play" style="width: 20px; height: 20px; vertical-align: middle; margin-right: 6px;"> Play</button>
        <button id="mpl-seq-stop-all" class="btn btn-secondary" style="min-width:100px;"><img src="images/STOP.png" alt="Stop" style="width: 20px; height: 20px; vertical-align: middle; margin-right: 6px;"> Stop</button>
        <button id="mpl-seq-clear-all" class="btn btn-secondary" style="min-width:100px;"><img src="images/CLEAR.png" alt="Clear" style="width: 20px; height: 20px; vertical-align: middle; margin-right: 6px;"> Clear</button>
        <button id="mpl-seq-check" class="btn btn-primary" style="min-width:140px;"><img src="images/mplscudo_check.png" alt="‚úì" style="width: 16px; height: 16px; vertical-align: middle; margin-right: 6px;"> Check Pattern</button>
      </div>
      <div class="sequencer-status" id="mpl-seq-status" aria-live="polite" style="margin-top:1rem;"><span>Click steps to activate them.</span></div>
    </section>

    <section class="completion-section" id="mpl-completion-section" style="display:none; margin-top: var(--space-2xl);">
      <div class="completion-card">
        <div class="completion-icon"><img src="images/check_green.png" alt="Completed" style="width: 3rem;"></div>
        <h2 class="completion-title">Lesson Complete!</h2>
        <p class="completion-message" id="mpl-completion-message"></p>
        <div class="completion-actions">
          <a href="#" id="mpl-next-lesson-btn" class="btn btn-primary">Next Lesson ‚Üí</a>
          <a href="labs.html" class="btn btn-secondary">All Lessons</a>
        </div>
      </div>
    </section>

    <!-- =================================================== -->
    <!-- EDUCATIONAL CONTENT: Advanced Polyrhythms -->
    <!-- =================================================== -->
    <section style="margin-top: var(--space-3xl); margin-bottom: var(--space-3xl);">
      <div class="card" style="padding: var(--space-2xl); background: var(--bg-card);">

        <h2 style="font-size: 2rem; font-weight: 700; margin-bottom: var(--space-lg); background: linear-gradient(135deg, #6c5ce7, #a29bfe); -webkit-background-clip: text; -webkit-text-fill-color: transparent;">Advanced Polyrhythms: 5:4 & Beyond</h2>

        <p style="font-size: 1.1rem; line-height: 1.8; margin-bottom: var(--space-lg); color: var(--text-primary);">
          The <strong>5:4 polyrhythm</strong> represents the next level of rhythmic complexity beyond 3:4. While 3:4 creates accessible bounce, <strong>5:4 creates hypnotic, cyclical tension</strong> that defines progressive rock, math rock, and experimental electronic music. Bands like <strong>King Crimson</strong>, <strong>Tool</strong>, and producers like <strong>Autechre</strong> use these advanced polyrhythms to create <em>disorienting yet compelling</em> grooves.
        </p>

        <p style="font-size: 1rem; line-height: 1.8; margin-bottom: var(--space-lg); color: var(--text-secondary);">
          Programming 5:4 requires a <strong>20-step grid</strong> (the LCM of 4 and 5). The kick divides 20 into <strong>4 equal parts</strong> (hitting every 5 steps), while the hi-hat divides into <strong>5 equal parts</strong> (hitting every 4 steps). The patterns align only on <strong>step 1</strong>, then drift apart, creating tension that resolves cyclically every 20 steps.
        </p>

        <div style="background: linear-gradient(135deg, rgba(108, 92, 231, 0.1), rgba(162, 155, 254, 0.1)); padding: var(--space-lg); border-radius: var(--radius-md); border-left: 4px solid #6c5ce7; margin-bottom: var(--space-xl);">
          <p style="font-style: italic; color: var(--text-primary); margin: 0;">
            <strong>Key Principle:</strong> Advanced polyrhythms aren't about <em>showing off</em>‚Äîthey're about creating <strong>rhythmic tension and resolution</strong>. Use them where the music demands complexity, not everywhere.
          </p>
        </div>

        <h3 style="font-size: 1.5rem; font-weight: 600; margin-top: var(--space-2xl); margin-bottom: var(--space-md);">Key Concepts</h3>

        <div style="background: var(--bg-secondary); padding: var(--space-lg); border-radius: var(--radius-md); margin-bottom: var(--space-lg); border-left: 4px solid #6c5ce7;">
          <h4 style="font-size: 1.2rem; font-weight: 600; margin-bottom: var(--space-sm); color: #6c5ce7;">1. The 5:4 Polyrhythm (20-Step Grid)</h4>
          <p style="line-height: 1.7; color: var(--text-secondary); margin-bottom: var(--space-sm);">
            <strong>Kick (the "4"):</strong> Steps 1, 6, 11, 16 (dividing 20 into 4 parts = every 5 steps)<br>
            <strong>Hi-hat (the "5"):</strong> Steps 1, 5, 9, 13, 17 (dividing 20 into 5 parts = every 4 steps)<br>
            <strong>Snare (anchor):</strong> Step 11 (middle point) helps listeners orient within the complexity
          </p>
          <p style="line-height: 1.7; color: var(--text-secondary); margin: 0;">
            <strong>The magic:</strong> Kick and hi-hat align <em>only on step 1</em>. Between steps 1-20, they drift apart creating <strong>cyclical tension</strong> that resolves when they meet again on step 1 of the next cycle.
          </p>
        </div>

        <div style="background: var(--bg-secondary); padding: var(--space-lg); border-radius: var(--radius-md); margin-bottom: var(--space-lg); border-left: 4px solid #a29bfe;">
          <h4 style="font-size: 1.2rem; font-weight: 600; margin-bottom: var(--space-sm); color: #a29bfe;">2. Metric Displacement</h4>
          <p style="line-height: 1.7; color: var(--text-secondary); margin-bottom: var(--space-sm);">
            <strong>Metric displacement</strong> shifts a pattern forward or backward in time without changing its internal rhythm. For example: take a standard rock beat and <strong>start it on step 2 instead of step 1</strong>. The pattern is identical, but its relationship to the downbeat changes, creating disorientation.
          </p>
          <p style="line-height: 1.7; color: var(--text-secondary); margin: 0;">
            <strong>Famous use:</strong> Tool's <em>"Schism"</em> uses metric displacement extensively‚Äîthe drums feel like they're <em>constantly shifting</em> relative to the guitars, even though each instrument maintains its own consistent pattern.
          </p>
        </div>

        <div style="background: var(--bg-secondary); padding: var(--space-lg); border-radius: var(--radius-md); margin-bottom: var(--space-lg); border-left: 4px solid #00cec9;">
          <h4 style="font-size: 1.2rem; font-weight: 600; margin-bottom: var(--space-sm); color: #00cec9;">3. Phase Shifting (Steve Reich)</h4>
          <p style="line-height: 1.7; color: var(--text-secondary); margin-bottom: var(--space-sm);">
            <strong>Phase shifting</strong> means gradually delaying one pattern relative to another. Composer <strong>Steve Reich</strong> pioneered this: two identical patterns start in sync, then one slowly drifts out of phase (1ms, 2ms, 3ms delay per bar), creating evolving polyrhythmic relationships.
          </p>
          <p style="line-height: 1.7; color: var(--text-secondary); margin: 0;">
            <strong>Modern application:</strong> In electronic music, automate the timing offset of a hi-hat pattern to gradually shift from <strong>0ms to 50ms</strong> over 32 bars. The pattern stays the same, but its relationship to the kick creates <em>constantly evolving groove</em>.
          </p>
        </div>

        <div style="background: var(--bg-secondary); padding: var(--space-lg); border-radius: var(--radius-md); margin-bottom: var(--space-xl); border-left: 4px solid #fdcb6e;">
          <h4 style="font-size: 1.2rem; font-weight: 600; margin-bottom: var(--space-sm); color: #fdcb6e;">4. When to Use Advanced Polyrhythms</h4>
          <p style="line-height: 1.7; color: var(--text-secondary); margin-bottom: var(--space-sm);">
            Advanced polyrhythms aren't appropriate for every genre or section. Use them when you want:<br>
            ‚Ä¢ <strong>Maximum tension</strong> (buildups, breakdowns, experimental sections)<br>
            ‚Ä¢ <strong>Hypnotic repetition</strong> (ambient, IDM, minimalist techno)<br>
            ‚Ä¢ <strong>Prog/math rock authenticity</strong> (the genre demands complexity)
          </p>
          <p style="line-height: 1.7; color: var(--text-secondary); margin: 0;">
            <strong>Don't use them:</strong> In pop choruses, dance floor bangers, or anywhere the listener needs to <em>immediately</em> latch onto the groove. Complexity can alienate as easily as it can intrigue.
          </p>
        </div>

        <h3 style="font-size: 1.5rem; font-weight: 600; margin-top: var(--space-2xl); margin-bottom: var(--space-md);">Common Mistakes</h3>

        <div style="background: linear-gradient(135deg, rgba(255, 107, 107, 0.1), rgba(255, 107, 107, 0.05)); padding: var(--space-lg); border-radius: var(--radius-md); margin-bottom: var(--space-lg); border-left: 4px solid #ff6b6b;">
          <h4 style="font-size: 1.1rem; font-weight: 600; color: #ff6b6b; margin-bottom: var(--space-sm);">‚ùå Complexity Without Purpose</h4>
          <p style="line-height: 1.7; color: var(--text-secondary); margin-bottom: var(--space-sm);">
            Using 5:4 polyrhythms just because you <em>can</em> is a beginner mistake. If the complexity doesn't serve the music's <strong>emotional intent</strong>, it's just showing off‚Äîand listeners will tune out.
          </p>
          <p style="line-height: 1.7; color: var(--text-primary); margin: 0;">
            <strong>Fix:</strong> Use polyrhythms <strong>intentionally</strong>‚Äîfor tension, hypnosis, or genre authenticity. If the song doesn't need it, don't force it.
          </p>
        </div>

        <div style="background: linear-gradient(135deg, rgba(254, 202, 87, 0.1), rgba(254, 202, 87, 0.05)); padding: var(--space-lg); border-radius: var(--radius-md); margin-bottom: var(--space-lg); border-left: 4px solid #feca57;">
          <h4 style="font-size: 1.1rem; font-weight: 600; color: #feca57; margin-bottom: var(--space-sm);">‚ùå No Anchor Point</h4>
          <p style="line-height: 1.7; color: var(--text-secondary); margin-bottom: var(--space-sm);">
            When <em>everything</em> is polyrhythmic, listeners have nothing to hold onto. The result is <strong>chaotic noise</strong>. Even Tool and King Crimson provide <strong>anchor points</strong>‚Äîbass lines, snare hits, or vocal phrases that orient the listener.
          </p>
          <p style="line-height: 1.7; color: var(--text-primary); margin: 0;">
            <strong>Fix:</strong> In this lesson, the <strong>snare on step 11</strong> acts as an anchor. Keep some element simple and predictable while others create complexity.
          </p>
        </div>

        <div style="background: linear-gradient(135deg, rgba(162, 155, 254, 0.1), rgba(162, 155, 254, 0.05)); padding: var(--space-lg); border-radius: var(--radius-md); margin-bottom: var(--space-xl); border-left: 4px solid #a29bfe;">
          <h4 style="font-size: 1.1rem; font-weight: 600; color: #a29bfe; margin-bottom: var(--space-sm);">‚ùå Wrong Grid Size</h4>
          <p style="line-height: 1.7; color: var(--text-secondary); margin-bottom: var(--space-sm);">
            Trying to program 5:4 on a <strong>16-step grid</strong> won't work‚Äî16 isn't divisible by both 4 and 5. You <em>must</em> use a <strong>20-step grid</strong> (the LCM of 4 and 5).
          </p>
          <p style="line-height: 1.7; color: var(--text-primary); margin: 0;">
            <strong>Fix:</strong> Always calculate the <strong>LCM (Lowest Common Multiple)</strong> of your ratio numbers. For 5:4 = 20 steps. For 7:4 = 28 steps. For 3:5 = 15 steps.
          </p>
        </div>

        <h3 style="font-size: 1.5rem; font-weight: 600; margin-top: var(--space-2xl); margin-bottom: var(--space-md);">Why This Matters</h3>

        <div style="background: linear-gradient(135deg, rgba(108, 92, 231, 0.1), rgba(162, 155, 254, 0.1)); padding: var(--space-xl); border-radius: var(--radius-md); margin-bottom: var(--space-xl); border: 1px solid rgba(108, 92, 231, 0.3);">
          <ul style="list-style: none; padding: 0; margin: 0; display: grid; gap: var(--space-lg);">
            <li style="display: flex; align-items: flex-start; gap: var(--space-md);">
              <span style="font-size: 1.5rem;">üéº</span>
              <div>
                <strong>Prog/Math Rock Essential:</strong> If you want to produce Tool, King Crimson, Meshuggah, or math rock, <strong>advanced polyrhythms are non-negotiable</strong>. They define the genre.
              </div>
            </li>
            <li style="display: flex; align-items: flex-start; gap: var(--space-md);">
              <span style="font-size: 1.5rem;">üß†</span>
              <div>
                <strong>Rhythmic Mastery:</strong> Understanding 5:4 polyrhythms trains your brain to think in <strong>multiple time layers simultaneously</strong>‚Äîa skill that elevates <em>all</em> your rhythm programming.
              </div>
            </li>
            <li style="display: flex; align-items: flex-start; gap: var(--space-md);">
              <span style="font-size: 1.5rem;">‚ú®</span>
              <div>
                <strong>Hypnotic Engagement:</strong> The cyclical tension/resolution of 5:4 creates <strong>mesmerizing patterns</strong> that keep listeners engaged on a <em>subconscious level</em>.
              </div>
            </li>
          </ul>
        </div>

        <h3 style="font-size: 1.5rem; font-weight: 600; margin-top: var(--space-2xl); margin-bottom: var(--space-md);">Congratulations!</h3>

        <p style="line-height: 1.8; color: var(--text-secondary); margin-bottom: var(--space-md);">
          You've completed the <strong>advanced drum programming curriculum</strong>! From basic patterns to polyrhythms, humanization to mixing, you now have the tools to create <strong>professional, expressive, genre-authentic drums</strong> across any style.
        </p>

        <div style="background: var(--bg-secondary); padding: var(--space-lg); border-radius: var(--radius-md); border-left: 4px solid #00b894;">
          <p style="margin: 0;">
            <strong>What's Next:</strong> Apply these techniques to <strong>real productions</strong>. Experiment with genres, blend techniques, and develop your unique drum programming style. The fundamentals are complete‚Äînow make them your own.
          </p>
        </div>

      </div>
    </section>
    <!-- END EDUCATIONAL CONTENT -->

  </main>

  <script type="module">
    import { lessonConfig } from './configs/lesson-drums-21.config.js';
    import { initLessonFromConfig } from './lesson-engine.js';
    initLessonFromConfig(lessonConfig);
  </script>
  <script src="theme-registry.js"></script>
  <script src="theme-manager.js"></script>
  <script src="navbar.js"></script>
</body>
</html>
