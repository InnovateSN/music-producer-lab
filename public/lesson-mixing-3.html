<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <title id="mpl-page-title">Lesson · Music Producer Lab</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0, viewport-fit=cover" />
    <meta name="description" id="mpl-meta-description" content="Interactive music production lesson from Music Producer Lab." />
    <meta name="theme-color" content="#030508">
    <link rel="icon" type="image/svg+xml" href="mpl-favicon.svg">
    <link rel="manifest" href="manifest.json">
    <link rel="stylesheet" href="styles.css">
  </head>
  <body>
    <div id="navbar-placeholder"></div>

    <main class="main-content container">

        <!-- HERO SECTION (populated by JS) -->
        <section class="hero" id="mpl-hero" aria-label="Lesson hero" style="display: flex; align-items: center; gap: var(--space-3xl);">
          <div class="hero-copy" style="flex: 1; max-width: none;">
            <div class="hero-copy-eyebrow" id="mpl-hero-eyebrow">Loading...</div>
            <h1 class="hero-title" id="mpl-hero-title">
              <span id="mpl-hero-title-main">Lesson</span>
              <span id="mpl-hero-title-highlight"></span>
            </h1>
            <p class="hero-subtitle" id="mpl-hero-subtitle"></p>
            <div id="mpl-hero-nav-btns" style="margin-top:1rem;display:flex;gap:0.6rem;flex-wrap:wrap;"></div>
          </div>

          <div class="hero-visual" style="flex: 1; display: flex; align-items: center; justify-content: center;">
            <img src="images/mpl_hero_rightside.png" alt="Music Production" style="width: 100%; max-width: 500px; height: auto; object-fit: contain; filter: drop-shadow(0 0 40px rgba(0, 212, 255, 0.3));">
          </div>
          </div>
        </section>

        <!-- EDUCATIONAL CONTENT -->
        <section style="margin-top: var(--space-3xl); margin-bottom: var(--space-3xl);">
          <div class="card" style="padding: var(--space-2xl); background: var(--bg-card); border: 1px solid var(--border-subtle);">

            <!-- INTRODUCTION -->
            <div class="section-eyebrow" style="margin-bottom: var(--space-md);">What You'll Learn</div>
            <h2 style="font-size: 2rem; margin-bottom: var(--space-lg); color: var(--text-primary);">Compression: Taming Dynamics, Adding Power</h2>

            <p style="font-size: 1.1rem; line-height: 1.8; color: var(--text-secondary); margin-bottom: var(--space-xl);">
              <a href="glossary.html#compression" style="color: var(--accent-cyan); text-decoration: underline;">Compression</a> is one of the most powerful and misunderstood tools in mixing. At its core, compression <strong>reduces the volume difference between the loudest and quietest parts</strong> of an audio signal—the <a href="glossary.html#dynamic-range" style="color: var(--accent-cyan); text-decoration: underline;">dynamic range</a>. Why does this matter? Because a vocal that whispers one word and shouts the next will disappear and then blast out of the mix. Compression smooths out those differences, making the performance <strong>consistent and controlled</strong>. But compression does more than level control: it can add <strong>punch</strong> to drums, <strong>sustain</strong> to guitars, <strong>glue</strong> to a mix bus, and <strong>energy</strong> to a master. In this lesson, you'll learn the five essential compressor controls—threshold, ratio, attack, release, and makeup gain—and how each shapes your sound.
            </p>

            <!-- KEY CONCEPTS GRID -->
            <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(280px, 1fr)); gap: var(--space-lg); margin-bottom: var(--space-2xl);">

              <!-- Concept 1: Threshold & Ratio -->
              <div style="padding: var(--space-lg); background: linear-gradient(135deg, rgba(255, 90, 61, 0.1), rgba(255, 178, 138, 0.1)); border-radius: var(--radius-md); border: 1px solid rgba(255, 90, 61, 0.2);">
                <div style="display: flex; align-items: center; gap: var(--space-sm); margin-bottom: var(--space-md);">
                  <img src="images/stats.png" alt="Threshold" style="width: 2rem; height: 2rem;">
                  <h3 style="font-size: 1.25rem; color: var(--accent-orange); margin: 0;">Threshold & Ratio</h3>
                </div>
                <p style="color: var(--text-secondary); line-height: 1.7;">
                  <strong>Threshold</strong> sets the level where compression begins. Audio below the threshold passes untouched; audio above it gets compressed. <strong>Ratio</strong> controls how much compression is applied: <strong>2:1</strong> means for every 2 dB above the threshold, only 1 dB comes out. <strong>4:1</strong> is moderate compression, <strong>8:1+</strong> is heavy limiting. Start with a <strong>-20 dB threshold and 3:1 ratio</strong> for gentle, musical compression.
                </p>
              </div>

              <!-- Concept 2: Attack & Release -->
              <div style="padding: var(--space-lg); background: linear-gradient(135deg, rgba(95, 77, 255, 0.1), rgba(138, 155, 255, 0.1)); border-radius: var(--radius-md); border: 1px solid rgba(95, 77, 255, 0.2);">
                <div style="display: flex; align-items: center; gap: var(--space-sm); margin-bottom: var(--space-md);">
                  <img src="images/orologio.png" alt="Timing" style="width: 2rem; height: 2rem;">
                  <h3 style="font-size: 1.25rem; color: var(--accent-purple); margin: 0;">Attack & Release: The Secret Weapons</h3>
                </div>
                <p style="color: var(--text-secondary); line-height: 1.7;">
                  <strong>Attack</strong> controls how fast the compressor reacts after the signal crosses the threshold. <strong>Fast attack (1-10 ms)</strong>: Catches <a href="glossary.html#transient" style="color: var(--accent-cyan); text-decoration: underline;">transients</a>—tames sharp peaks but can kill punch. <strong>Slow attack (30-100 ms)</strong>: Lets transients through, then clamps down—<strong>adds punch and snap</strong> to drums. <strong>Release</strong> controls how fast compression stops. Too fast = pumping artifacts. Too slow = over-compressed, lifeless sound. <strong>Match release to the tempo</strong> of your track for musical results.
                </p>
              </div>

              <!-- Concept 3: Makeup Gain -->
              <div style="padding: var(--space-lg); background: linear-gradient(135deg, rgba(0, 212, 255, 0.1), rgba(184, 255, 221, 0.1)); border-radius: var(--radius-md); border: 1px solid rgba(0, 212, 255, 0.2);">
                <div style="display: flex; align-items: center; gap: var(--space-sm); margin-bottom: var(--space-md);">
                  <img src="images/speaker.png" alt="Gain" style="width: 2rem; height: 2rem;">
                  <h3 style="font-size: 1.25rem; color: var(--accent-cyan); margin: 0;">Makeup Gain & Gain Reduction</h3>
                </div>
                <p style="color: var(--text-secondary); line-height: 1.7;">
                  Compression reduces overall <a href="glossary.html#volume" style="color: var(--accent-cyan); text-decoration: underline;">volume</a> (because it's turning down the loud parts). <strong>Makeup gain</strong> compensates by boosting the output back up. The key metric to watch is the <strong>gain reduction (GR) meter</strong>: for most mixing applications, aim for <strong>3-6 dB of gain reduction</strong>. More than 10 dB usually means you're over-compressing. Always A/B with bypass at <strong>matched volume</strong> to judge the actual effect, not just the loudness change.
                </p>
              </div>

              <!-- Concept 4: Types of Compression -->
              <div style="padding: var(--space-lg); background: linear-gradient(135deg, rgba(179, 102, 255, 0.1), rgba(255, 102, 178, 0.1)); border-radius: var(--radius-md); border: 1px solid rgba(179, 102, 255, 0.2);">
                <div style="display: flex; align-items: center; gap: var(--space-sm); margin-bottom: var(--space-md);">
                  <img src="images/gear.png" alt="Types" style="width: 2rem; height: 2rem;">
                  <h3 style="font-size: 1.25rem; color: var(--accent-magenta); margin: 0;">Compressor Character Types</h3>
                </div>
                <p style="color: var(--text-secondary); line-height: 1.7;">
                  <strong>VCA</strong> (SSL-style): Clean, precise, transparent—great for drums and bus compression. <strong>FET</strong> (1176-style): Fast, aggressive, colorful—perfect for vocals and room mics. <strong>Optical</strong> (LA-2A-style): Smooth, musical, slow—ideal for bass and vocals. <strong>Tube/Variable-Mu</strong>: Warm, glue-like—classic for master bus and bus compression. Each type has a distinct sonic character that suits different sources.
                </p>
              </div>

            </div>

            <!-- VISUAL: COMPRESSION IN ACTION -->
            <div style="padding: var(--space-xl); background: var(--bg-secondary); border-radius: var(--radius-lg); margin-bottom: var(--space-2xl);">
              <h3 style="font-size: 1.5rem; margin-bottom: var(--space-lg); color: var(--text-primary);">Compression in Action: Before vs. After</h3>

              <div style="display: grid; grid-template-columns: 1fr 1fr; gap: var(--space-lg);">
                <!-- Before -->
                <div style="padding: var(--space-md); background: rgba(255, 90, 61, 0.05); border-radius: var(--radius-md); border: 1px solid rgba(255, 90, 61, 0.2);">
                  <h4 style="color: var(--accent-orange); margin-bottom: var(--space-md); font-size: 0.9rem;">Before Compression</h4>
                  <div style="display: flex; align-items: flex-end; gap: 3px; height: 120px; padding: var(--space-sm);">
                    <div style="width: 12%; background: var(--accent-orange); height: 30%; border-radius: 2px 2px 0 0;"></div>
                    <div style="width: 12%; background: var(--accent-orange); height: 95%; border-radius: 2px 2px 0 0;"></div>
                    <div style="width: 12%; background: var(--accent-orange); height: 20%; border-radius: 2px 2px 0 0;"></div>
                    <div style="width: 12%; background: var(--accent-orange); height: 85%; border-radius: 2px 2px 0 0;"></div>
                    <div style="width: 12%; background: var(--accent-orange); height: 15%; border-radius: 2px 2px 0 0;"></div>
                    <div style="width: 12%; background: var(--accent-orange); height: 100%; border-radius: 2px 2px 0 0;"></div>
                    <div style="width: 12%; background: var(--accent-orange); height: 25%; border-radius: 2px 2px 0 0;"></div>
                    <div style="width: 12%; background: var(--accent-orange); height: 60%; border-radius: 2px 2px 0 0;"></div>
                  </div>
                  <p style="font-size: 0.75rem; color: var(--text-muted); margin-top: var(--space-sm);">Wide dynamic range: quiet parts disappear, loud parts dominate</p>
                </div>

                <!-- After -->
                <div style="padding: var(--space-md); background: rgba(0, 212, 255, 0.05); border-radius: var(--radius-md); border: 1px solid rgba(0, 212, 255, 0.2);">
                  <h4 style="color: var(--accent-cyan); margin-bottom: var(--space-md); font-size: 0.9rem;">After Compression</h4>
                  <div style="display: flex; align-items: flex-end; gap: 3px; height: 120px; padding: var(--space-sm);">
                    <div style="width: 12%; background: var(--accent-cyan); height: 55%; border-radius: 2px 2px 0 0;"></div>
                    <div style="width: 12%; background: var(--accent-cyan); height: 75%; border-radius: 2px 2px 0 0;"></div>
                    <div style="width: 12%; background: var(--accent-cyan); height: 45%; border-radius: 2px 2px 0 0;"></div>
                    <div style="width: 12%; background: var(--accent-cyan); height: 70%; border-radius: 2px 2px 0 0;"></div>
                    <div style="width: 12%; background: var(--accent-cyan); height: 40%; border-radius: 2px 2px 0 0;"></div>
                    <div style="width: 12%; background: var(--accent-cyan); height: 80%; border-radius: 2px 2px 0 0;"></div>
                    <div style="width: 12%; background: var(--accent-cyan); height: 50%; border-radius: 2px 2px 0 0;"></div>
                    <div style="width: 12%; background: var(--accent-cyan); height: 65%; border-radius: 2px 2px 0 0;"></div>
                  </div>
                  <p style="font-size: 0.75rem; color: var(--text-muted); margin-top: var(--space-sm);">Controlled dynamics: everything sits consistently in the mix</p>
                </div>
              </div>
            </div>

            <!-- COMMON MISTAKES -->
            <div style="margin-bottom: var(--space-2xl);">
              <h3 style="font-size: 1.5rem; margin-bottom: var(--space-lg); color: var(--text-primary);">
                <img src="images/mplalert.png" alt="Warning" style="width: 1.5rem; height: 1.5rem; vertical-align: middle;"> Common Mistakes
              </h3>

              <!-- Mistake 1 -->
              <div style="padding: var(--space-lg); background: rgba(255, 90, 61, 0.05); border-left: 4px solid var(--accent-orange); border-radius: var(--radius-md); margin-bottom: var(--space-md);">
                <h4 style="color: var(--accent-orange); margin-bottom: var(--space-sm);">Over-Compressing Everything</h4>
                <p style="color: var(--text-secondary); line-height: 1.7;">
                  The most common mistake is using too much compression on every track. Over-compressed audio sounds <strong>flat, lifeless, and squashed</strong>. Drums lose their punch, vocals lose their expression, and the whole mix sounds fatiguing. Not every track needs compression. Start with <strong>no compression</strong> and only add it when you hear a specific problem (inconsistent volume, lack of sustain, need for punch).
                </p>
              </div>

              <!-- Mistake 2 -->
              <div style="padding: var(--space-lg); background: rgba(95, 77, 255, 0.05); border-left: 4px solid var(--accent-purple); border-radius: var(--radius-md); margin-bottom: var(--space-md);">
                <h4 style="color: var(--accent-purple); margin-bottom: var(--space-sm);">Confusing "Louder" With "Better"</h4>
                <p style="color: var(--text-secondary); line-height: 1.7;">
                  Makeup <a href="glossary.html#gain" style="color: var(--accent-cyan); text-decoration: underline;">gain</a> makes the compressed signal louder, and our brains perceive louder as better. This tricks you into thinking compression is always improving the sound. <strong>Always A/B test at matched volumes</strong>: bypass the compressor, match the levels, then compare. If it doesn't sound better at the same volume, it's not helping.
                </p>
              </div>

              <!-- Mistake 3 -->
              <div style="padding: var(--space-lg); background: rgba(0, 212, 255, 0.05); border-left: 4px solid var(--accent-cyan); border-radius: var(--radius-md);">
                <h4 style="color: var(--accent-cyan); margin-bottom: var(--space-sm);">Wrong Attack Time on Drums</h4>
                <p style="color: var(--text-secondary); line-height: 1.7;">
                  Using a fast attack on drums kills the <a href="glossary.html#transient" style="color: var(--accent-cyan); text-decoration: underline;">transient</a>—the initial snap that gives drums their punch. For punchy, impactful drums, use a <strong>slow attack (20-50 ms)</strong> so the transient passes through before compression kicks in. Then the body and sustain get compressed, making the transient even more prominent by contrast. Fast attack is only useful when you specifically want to soften or smooth the initial hit.
                </p>
              </div>
            </div>

            <!-- WHY THIS MATTERS -->
            <div style="padding: var(--space-xl); background: linear-gradient(135deg, rgba(0, 212, 255, 0.08), rgba(179, 102, 255, 0.08)); border-radius: var(--radius-lg); border: 1px solid rgba(0, 212, 255, 0.15);">
              <h3 style="font-size: 1.5rem; margin-bottom: var(--space-lg); color: var(--text-primary);">
                <img src="images/idea.png" alt="Why" style="width: 1.5rem; height: 1.5rem; vertical-align: middle;"> Why This Matters
              </h3>
              <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(250px, 1fr)); gap: var(--space-md);">
                <div style="display: flex; align-items: flex-start; gap: var(--space-sm);">
                  <img src="images/check_green.png" alt="Benefit" style="width: 1.2rem; height: 1.2rem; margin-top: 4px; flex-shrink: 0;">
                  <p style="color: var(--text-secondary); line-height: 1.6;"><strong>Consistent Vocals</strong> — Compression keeps every word audible without sudden volume jumps. Essential for professional vocal production.</p>
                </div>
                <div style="display: flex; align-items: flex-start; gap: var(--space-sm);">
                  <img src="images/check_green.png" alt="Benefit" style="width: 1.2rem; height: 1.2rem; margin-top: 4px; flex-shrink: 0;">
                  <p style="color: var(--text-secondary); line-height: 1.6;"><strong>Punchy Drums</strong> — The right attack/release settings add snap, power, and groove to your drum bus.</p>
                </div>
                <div style="display: flex; align-items: flex-start; gap: var(--space-sm);">
                  <img src="images/check_green.png" alt="Benefit" style="width: 1.2rem; height: 1.2rem; margin-top: 4px; flex-shrink: 0;">
                  <p style="color: var(--text-secondary); line-height: 1.6;"><strong>Mix Glue</strong> — Bus compression subtly blends elements together, making the mix feel cohesive rather than a collection of separate tracks.</p>
                </div>
                <div style="display: flex; align-items: flex-start; gap: var(--space-sm);">
                  <img src="images/check_green.png" alt="Benefit" style="width: 1.2rem; height: 1.2rem; margin-top: 4px; flex-shrink: 0;">
                  <p style="color: var(--text-secondary); line-height: 1.6;"><strong>Loudness & Energy</strong> — Controlled dynamics let you push the overall level higher in mastering, creating a louder, more impactful final product.</p>
                </div>
              </div>
            </div>

          </div>
        </section>

        <!-- THEORY SECTION (populated by JS from config) -->
        <section id="mpl-theory-section" style="margin-bottom: var(--space-2xl);"></section>

        <!-- EXERCISE INSTRUCTIONS (populated by JS) -->
        <section class="exercise-instructions" id="mpl-exercise-section" style="margin-top: var(--space-2xl);">
          <div class="exercise-box">
            <div class="section-eyebrow">Exercise</div>
            <h2 class="section-title" id="mpl-exercise-title">Loading exercise...</h2>
            <p class="section-body" id="mpl-exercise-description"></p>
            
            <div class="exercise-steps" id="mpl-exercise-steps-wrap">
              <h3>What to do:</h3>
              <ol class="exercise-checklist" id="mpl-exercise-steps"></ol>
            </div>

            <div class="exercise-tip" id="mpl-exercise-tip" style="display:none;">
              <strong>Tip:</strong> <span id="mpl-exercise-tip-text"></span>
            </div>

            <!-- PATTERN HINT (populated by JS) -->
            <div class="pattern-hint" id="mpl-pattern-hint" style="display:none;">
              <div class="pattern-hint-label">Target Pattern:</div>
              <div id="mpl-pattern-hint-grid"></div>
              <div id="mpl-pattern-hint-note"></div>
            </div>
          </div>
        </section>

        <!-- SEQUENCER CONTAINER (populated by JS) -->
        <section id="mpl-sequencer-container" style="margin-top: var(--space-2xl);"></section>

        <!-- COMPLETION MESSAGE (populated by JS) -->
        <div id="mpl-completion-message" class="completion-message" style="display:none;"></div>


      <!-- SCRIPT IMPORTS -->
      <script type="module">
        import { lessonConfig } from './configs/lesson-mixing-3.config.js';
        import { initLessonFromConfig } from './lesson-engine.js';
        
        // Initialize lesson with config
        if (window.LESSON_CONFIG) {
          initLessonFromConfig(window.LESSON_CONFIG);
        } else {
          initLessonFromConfig(lessonConfig);
        }
      </script>
    </main>

    <!-- FOOTER -->
    <footer class="site-footer">
      <div class="container footer-grid">
        <p class="copyright">© <span id="mpl-year">2025</span> Music Producer Lab</p>
        <nav class="footer-nav">
          <a href="labs.html">Labs</a>
          <a href="index.html">Home</a>
        </nav>
      </div>
    </footer>
    <script>document.getElementById("mpl-year").textContent = new Date().getFullYear();</script>
  <script src="theme-registry.js"></script>
  <script src="theme-manager.js"></script>
    <script src="navbar.js"></script>
  </body>
</html>
